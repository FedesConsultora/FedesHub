@use '../../styles/variables' as v;

.TareasFilters{
  position: relative;
  margin-top: 1.5rem;
  .srOnly{ position:absolute!important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }

  .searchBox{
    position: relative;
    display: grid;
    gap: 6px;

    /* Input “clean”: gris claro + texto oscuro */
    input[type="search"]{
      width: 100%;
      height: 44px;
      padding: 10px 48px 10px 14px;
      border: 1px solid #d4d9e2;
      border-radius: 12px;
      background: #eef2f7;
      color: #fff;
      transition: border-color .18s, box-shadow .18s, background .18s;

      -webkit-transition: border-color .18s, box-shadow .18s, background .18s;
      -moz-transition: border-color .18s, box-shadow .18s, background .18s;
      -ms-transition: border-color .18s, box-shadow .18s, background .18s;
      -o-transition: border-color .18s, box-shadow .18s, background .18s;
      &::placeholder{ color: rgba(255,255,255,.7); } 
      &:focus{
        border-color: #{v.$fh-primary};
        box-shadow: 0 0 0 3px rgba(68,113,141,.28);
        outline: none;
        background: #f4f6fa;        /* un toque más claro al enfocar */
      }
    }

    /* Flecha (toggle) DENTRO del input, sin bordes ni caja */
    .caretBtn{
      position: absolute;
      right: 6px;
      top: 50%;
      transform: translateY(-50%);
      height: 32px;
      width: 32px;
      display: grid;
      place-items: center;
      border: 0;                    /* sin borde */
      background: transparent;      /* sin fondo */
      cursor: pointer;
      color: #ffffff;               /* ícono oscuro */
      padding: 0;

      /* accesibilidad al tab */
      &:focus-visible{
        outline: 2px solid #{v.$fh-primary};
        outline-offset: 2px;
        border-radius: 6px;
      }

      /* rotación al abrir */
      &[aria-expanded="true"] svg{ transform: rotate(180deg); }
      svg{ transition: transform .18s ease; display: block; }
    }
  }

  /* —— POPOVER —— */
  .filterPopover{
    position: absolute; top: calc(100% + 10px); right: 0; z-index: 30;
    width: min(960px, 95vw); max-height: min(72vh, 640px); overflow:auto;

    background: #0e151d; color: #e5eef6;
    border: 1px solid #1f2b38; border-radius: 16px;
    box-shadow: 0 24px 60px rgba(0,0,0,.55), 0 6px 22px rgba(0,0,0,.35);
    padding: 14px;

    &::before{
      content:""; position:absolute; top:-8px; right:18px;
      width:16px; height:16px; background:#0e151d;
      border-left:1px solid #1f2b38; border-top:1px solid #1f2b38;
      transform: rotate(45deg);
    }

    .popHead{
      display:flex; justify-content:space-between; align-items:center; padding-bottom:10px;
      border-bottom:1px solid #1f2b38;
      strong{ font-weight:900; letter-spacing:.2px; }
      .btnX{ appearance:none; border:0; background:transparent; font-size:20px; line-height:1; cursor:pointer; color:#e5eef6; opacity:.7; &:hover{ opacity:1 } }
    }

    .grid{
      display:grid; gap:14px; margin-top:12px;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); /* nunca se aprieta */
    }

    /* —— PRIMITIVES —— */
    .Field{ display:grid; gap:8px; min-width:0; }
    .Field__label{ font-size:12px; font-weight:800; color:#cbd6e2; letter-spacing:.2px; }

    .Fieldset{ display:grid; gap:10px; min-width:0; }
    .Fieldset__legend{ font-size:12px; font-weight:800; color:#cbd6e2; letter-spacing:.2px; }

    /* controles base */
    select, input[type="date"], .InputDate > input{
      height:44px; padding:0 12px; width:100%;
      border:1px solid #283545; border-radius:12px;
      background:#0b121a; color:#e5eef6;
      transition: border-color .18s, box-shadow .18s, background .18s;
      &:focus{ border-color: v.$fh-primary; box-shadow:0 0 0 3px rgba(68,113,141,.35); outline:none }
    }

    /* date con icono */
    .InputDate{ position:relative; }
    .InputDate__icon{
      position:absolute; left:10px; top:50%; transform: translateY(-50%);
      pointer-events:none; opacity:.8;
    }
    .InputDate > input{ padding-left:36px; }
    input[type="date"]::-webkit-calendar-picker-indicator{ filter: invert(1) opacity(.85); }

    /* filas inline */
    .inline{ display:grid; gap:10px; align-items:end; }
    .inline.two{ grid-template-columns: 1fr auto 1fr; }
    .inline.auto{ grid-template-columns: 1fr 140px; }
    .sep{ align-self:center; opacity:.6; padding:0 2px; }

    .span-2{ grid-column: span 2; }

    .actions{
      position: sticky; bottom:0; margin-top:12px; padding-top:12px;
      background: linear-gradient(180deg, transparent, rgba(14,21,29,.9));
      display:flex; gap:8px; justify-content:flex-end;
      .btn{
        padding:10px 14px; border-radius:12px; font-weight:800; letter-spacing:.2px; cursor:pointer;
        &.clear{ border:1px solid #2a3646; background:#0b121a; color:#e5eef6; }
        &.apply{ border:1px solid transparent; background: v.$fh-primary; color:#fff; }
        &.clear:hover{ background:#0e151d }
        &.apply:hover{ filter:brightness(1.05); }
      }
    }
  }

  /* móvil: columna única y popover ancho completo */
  @media (max-width: 640px){
    .filterPopover{
      left: 0; right: 0; width: auto; margin: 0 4px; border-radius: 14px;
      &::before{ right: 32px; }
      .grid{ grid-template-columns: 1fr; }
      .span-2{ grid-column: auto; }
      .inline.two, .inline.auto{ grid-template-columns: 1fr; }
      .actions .btn{ flex:1 1 0; }
    }
  }
}
